<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <button id="connectWallet">连接钱包</button>
    <div id="balance"></div>
  </head>
  <body>
    <script type="module">
      document
        .getElementById('connectWallet')
        .addEventListener('click', async () => {
          if (typeof window.ethereum === 'undefined') {
            console.log('请安装MetaMask插件');
          } else {
            console.log('MetaMask插件已安装');
          }

          try {
            // 获取账户
            const accounts = await ethereum.request({
              method: 'eth_requestAccounts',
            });
            const address = accounts[0];
            console.log(address);

            // 获取账户余额
            const balance = await ethereum.request({
              method: 'eth_getBalance',
              params: [address, 'latest'],
            });

            // 转换为以太坊单位
            const balanceToEth = balance / 1e18;

            console.log(balanceToEth);

            // 获取网络
            const network = await ethereum.request({
              method: 'net_version',
            });
            console.log(network);

            document.getElementById('balance').innerHTML = `
              地址: ${address} <br>
              余额: ${balanceToEth} ETH <br>
              网络: ${network} <br>
            `;
          } catch (error) {
            console.log(error);
          }
        });
    </script>
  </body>
</html>
