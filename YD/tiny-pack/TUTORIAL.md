# TinyPack å®Œæ•´æ•™ç¨‹

> ä»é›¶å¼€å§‹æ„å»ºä¸€ä¸ª JavaScript æ¨¡å—æ‰“åŒ…å™¨ï¼Œæ·±å…¥ç†è§£ Webpack çš„æ ¸å¿ƒåŸç†

## ä¸ºä»€ä¹ˆè¦å­¦ä¹  TinyPackï¼Ÿ

TinyPack æ˜¯ä¸€ä¸ªç²¾ç®€ä½†åŠŸèƒ½å®Œæ•´çš„æ¨¡å—æ‰“åŒ…å™¨å®ç°ï¼Œå®ƒåŒ…å«äº†ç°ä»£æ‰“åŒ…å·¥å…·çš„æ ¸å¿ƒç‰¹æ€§ï¼š

- **ä¾èµ–å›¾æ„å»º**ï¼šè‡ªåŠ¨åˆ†æå’Œæ”¶é›†æ¨¡å—ä¾èµ–
- **ä»£ç è½¬æ¢**ï¼šå°† ES6+ æ¨¡å—è¯­æ³•è½¬æ¢ä¸º CommonJS
- **æ’ä»¶ç³»ç»Ÿ**ï¼šåŸºäº Tapable çš„ç”Ÿå‘½å‘¨æœŸé’©å­
- **Loader æœºåˆ¶**ï¼šæ”¯æŒå¼‚æ„èµ„æºå¤„ç†ï¼ˆå¦‚ Markdownã€CSSï¼‰
- **Bundle ç”Ÿæˆ**ï¼šå°†å¤šä¸ªæ¨¡å—æ‰“åŒ…æˆå•ä¸€å¯æ‰§è¡Œæ–‡ä»¶

é€šè¿‡å®ç° TinyPackï¼Œä½ å°†æ·±å…¥ç†è§£ï¼š
- Webpack/Rollup ç­‰æ‰“åŒ…å·¥å…·çš„å·¥ä½œåŸç†
- ASTï¼ˆæŠ½è±¡è¯­æ³•æ ‘ï¼‰çš„è§£æå’Œè½¬æ¢
- æ¨¡å—åŒ–ç³»ç»Ÿçš„è¿è¡Œæ—¶å®ç°
- æ’ä»¶æ¶æ„çš„è®¾è®¡æ¨¡å¼

## æ•™ç¨‹ç»“æ„

æœ¬æ•™ç¨‹åˆ†ä¸º 4 ä¸ªæ¸è¿›å¼ç« èŠ‚ï¼Œæ¯ç« éƒ½åŒ…å«ç†è®ºè®²è§£ã€ä»£ç å®ç°å’Œå®è·µç»ƒä¹ ï¼š

### ğŸ“– [ç¬¬ä¸€ç« ï¼šå¿«é€Ÿå¼€å§‹](./tutorial/01-quick-start.md)
- 5 åˆ†é’Ÿäº†è§£ TinyPack çš„è¿è¡Œæ•ˆæœ
- é¡¹ç›®ç»“æ„æ¦‚è§ˆ
- æ ¸å¿ƒæ¦‚å¿µé€Ÿè§ˆ
- ç¬¬ä¸€ä¸ªæ‰“åŒ…ç¤ºä¾‹

### ğŸ—ï¸ [ç¬¬äºŒç« ï¼šæ ¸å¿ƒæ¶æ„æ·±åº¦å‰–æ](./tutorial/02-core-architecture.md)
- Compilerï¼šæ„å»ºæµç¨‹çš„æŒ‡æŒ¥ä¸­å¿ƒ
- Compilationï¼šä¾èµ–å›¾çš„æ„å»ºå™¨
- Parserï¼šä»£ç è½¬æ¢çš„å¼•æ“
- Bundlerï¼šè¿è¡Œæ—¶çš„å®ç°

### ğŸ”§ [ç¬¬ä¸‰ç« ï¼šParser ä¸ AST è½¬æ¢è¯¦è§£](./tutorial/03-parser-ast.md)
- Acorn è§£æå™¨çš„ä½¿ç”¨
- import/export è¯­æ³•è½¬æ¢
- ä¾èµ–æ”¶é›†æœºåˆ¶
- MagicString çš„ä»£ç æ”¹å†™æŠ€å·§

### ğŸš€ [ç¬¬å››ç« ï¼šé«˜çº§ç‰¹æ€§å®ç°](./tutorial/04-advanced-features.md)
- Loader ç³»ç»Ÿçš„è®¾è®¡ä¸å®ç°
- Plugin ç”Ÿå‘½å‘¨æœŸé’©å­
- æ”¯æŒæ›´å¤šæ¨¡å—è¯­æ³•
- æ€§èƒ½ä¼˜åŒ–æŠ€å·§

### ğŸ› [æ•…éšœæ’æŸ¥æŒ‡å—](./tutorial/troubleshooting.md)
- å¸¸è§é”™è¯¯åŠè§£å†³æ–¹æ¡ˆ
- è°ƒè¯•æŠ€å·§
- æœ€ä½³å®è·µ

## å¿«é€Ÿå¼€å§‹

```bash
# å…‹éš†é¡¹ç›®
cd YD/tiny-pack

# å®‰è£…ä¾èµ–
npm install

# è¿è¡Œç¤ºä¾‹
node bin/tinypack.js

# æ‰§è¡Œæ‰“åŒ…åçš„ä»£ç 
node dist/bundle.js
```

## æ ¸å¿ƒæ–‡ä»¶ç»“æ„

```
tiny-pack/
â”œâ”€â”€ bin/
â”‚   â””â”€â”€ tinypack.js          # CLI å…¥å£
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ Compiler.js          # æ„å»ºæµç¨‹æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ Compilation.js       # ä¾èµ–å›¾æ„å»ºå™¨
â”‚   â”œâ”€â”€ Parser.js            # ä»£ç è§£æä¸è½¬æ¢
â”‚   â”œâ”€â”€ bundler.js           # Bundle ç”Ÿæˆå™¨
â”‚   â”œâ”€â”€ LoaderRunner.js      # Loader æ‰§è¡Œå™¨
â”‚   â””â”€â”€ HookSystem.js        # æ’ä»¶é’©å­ç³»ç»Ÿ
â”œâ”€â”€ loaders/
â”‚   â””â”€â”€ markdown-loader.js   # Markdown å¤„ç†ç¤ºä¾‹
â”œâ”€â”€ plugins/
â”‚   â””â”€â”€ ConsoleLogPlugin.js  # æ’ä»¶ç¤ºä¾‹
â”œâ”€â”€ examples/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ index.js        # ç¤ºä¾‹å…¥å£
â”‚   â”‚   â”œâ”€â”€ data.js         # ç¤ºä¾‹æ¨¡å—
â”‚   â”‚   â””â”€â”€ readme.md       # ç¤ºä¾‹ Markdown
â”‚   â””â”€â”€ tinypack.config.js  # é…ç½®æ–‡ä»¶
â””â”€â”€ dist/
    â””â”€â”€ bundle.js           # æ‰“åŒ…äº§ç‰©
```

## æ ¸å¿ƒæµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CLI      â”‚  è¯»å–é…ç½®ï¼Œå¯åŠ¨æ„å»º
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Compiler   â”‚  æ§åˆ¶æ„å»ºç”Ÿå‘½å‘¨æœŸ
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  run â†’ emit â†’ done
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Compilation â”‚  æ„å»ºä¾èµ–å›¾
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  buildModule â†’ æ”¶é›†ä¾èµ– â†’ é€’å½’å¤„ç†
       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚              â”‚
       â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Loader  â”‚    â”‚  Parser  â”‚  ä»£ç è½¬æ¢
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚               â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚   Bundler   â”‚  ç”Ÿæˆæœ€ç»ˆäº§ç‰©
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å…³é”®æŠ€æœ¯æ ˆ

- **acorn**ï¼šJavaScript è§£æå™¨ï¼Œç”Ÿæˆ AST
- **acorn-walk**ï¼šAST éå†å·¥å…·
- **magic-string**ï¼šé«˜æ•ˆçš„å­—ç¬¦ä¸²æ“ä½œåº“
- **tapable**ï¼šWebpack ä½¿ç”¨çš„æ’ä»¶ç³»ç»Ÿ
- **marked**ï¼šMarkdown è§£æå™¨ï¼ˆç¤ºä¾‹ç”¨ï¼‰

## å­¦ä¹ è·¯å¾„å»ºè®®

### åˆå­¦è€…è·¯å¾„
1. å…ˆé˜…è¯»[ç¬¬ä¸€ç« ](./tutorial/01-quick-start.md)ï¼Œè¿è¡Œç¤ºä¾‹æ„Ÿå—æ•ˆæœ
2. ç†è§£[ç¬¬äºŒç« ](./tutorial/02-core-architecture.md)çš„æ ¸å¿ƒæ¶æ„
3. æ ¹æ®éœ€è¦æ·±å…¥[ç¬¬ä¸‰ç« ](./tutorial/03-parser-ast.md)å’Œ[ç¬¬å››ç« ](./tutorial/04-advanced-features.md)

### è¿›é˜¶å¼€å‘è€…è·¯å¾„
1. å¿«é€Ÿæµè§ˆç¬¬ä¸€ç« 
2. é‡ç‚¹ç ”ç©¶ç¬¬ä¸‰ç« çš„ AST è½¬æ¢æœºåˆ¶
3. å°è¯•å®ç°è‡ªå®šä¹‰ Loader å’Œ Plugin
4. é˜…è¯»æºç ï¼Œå¯¹æ¯” Webpack çš„å®ç°å·®å¼‚

## å®è·µå»ºè®®

### è¾¹å­¦è¾¹åš
- æ¯è¯»å®Œä¸€ç« ï¼Œå°è¯•ä¿®æ”¹ä»£ç éªŒè¯ç†è§£
- æ·»åŠ  `console.log` è§‚å¯Ÿä¸­é—´çŠ¶æ€
- å°è¯•å¤„ç†æ–°çš„æ–‡ä»¶ç±»å‹ï¼ˆCSSã€JSON ç­‰ï¼‰

### åŠ¨æ‰‹å®éªŒ
- å®ç°ä¸€ä¸ª CSS Loader
- æ·»åŠ ä»£ç å‹ç¼©åŠŸèƒ½
- æ”¯æŒ Source Map
- å®ç°ä»£ç åˆ†å‰²ï¼ˆCode Splittingï¼‰

### æ·±å…¥æ¢ç´¢
- å¯¹æ¯” Webpack çš„ Module Federation
- ç ”ç©¶ Vite çš„ ESM å¼€å‘æ¨¡å¼
- äº†è§£ Rollup çš„ Tree Shaking åŸç†

## å‚è€ƒèµ„æº

- [Webpack å®˜æ–¹æ–‡æ¡£](https://webpack.js.org/)
- [Acorn è§£æå™¨æ–‡æ¡£](https://github.com/acornjs/acorn)
- [Tapable æ’ä»¶ç³»ç»Ÿ](https://github.com/webpack/tapable)
- [AST Explorer](https://astexplorer.net/) - å¯è§†åŒ– AST å·¥å…·

## è´¡çŒ®ä¸åé¦ˆ

å¦‚æœä½ å‘ç°æ•™ç¨‹ä¸­çš„é—®é¢˜æˆ–æœ‰æ”¹è¿›å»ºè®®ï¼Œæ¬¢è¿æå‡º Issue æˆ– PRï¼

## ä¸‹ä¸€æ­¥

å‡†å¤‡å¥½äº†å—ï¼Ÿè®©æˆ‘ä»¬ä»[ç¬¬ä¸€ç« ï¼šå¿«é€Ÿå¼€å§‹](./tutorial/01-quick-start.md)å¼€å§‹å§ï¼
